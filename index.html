<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PandaMania â€¢ OpenSea Live Stats</title>
  <style>
    :root { --bg:#0b0f0e; --card:#0f1513; --text:#e9ffee; --muted:#99ffcc; --accent:#39ff9e; }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:860px;margin:40px auto;padding:24px}
    .title{font-size:28px;font-weight:700;letter-spacing:.3px;margin-bottom:16px;text-shadow:0 0 10px #0f0}
    .bar{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:18px}
    select,input,button{background:#0e1512;color:var(--text);border:1px solid #264;outline:none;padding:10px 12px;border-radius:10px}
    button{cursor:pointer;box-shadow:0 0 12px rgba(57,255,158,.2)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
    .card{background:var(--card);padding:16px;border-radius:16px;box-shadow:0 0 24px rgba(57,255,158,.12), inset 0 0 0 1px rgba(57,255,158,.15)}
    .name{font-size:18px;font-weight:600;color:var(--muted);margin-bottom:8px}
    .stat{margin:6px 0;color:#d9ffe8}
    .err{color:#ffb3b3}
    a{color:var(--muted);text-decoration:none}
    small{opacity:.8}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">PandaMania â€¢ OpenSea Live Stats</div>
    <div class="bar">
      <select id="slug">
        <option value="pandamania">PandaMania</option>
        <option value="red-panda-pals">Red Panda Pals</option>
        <option value="bamboo-buddies">Bamboo Buddies</option>
        <option value="panda-cubs">Panda Cubs</option>
        <option value="red-panda-cubs">Red Panda Cubs</option>
        <option value="bamboo-shoots-1" selected>Bamboo Shoots</option>
      </select>
      <input id="site" placeholder="Your Netlify site, e.g. https://nimble-faun-7db959.netlify.app" style="min-width:360px" />
      <button id="go">Fetch</button>
      <small>Function path: /.netlify/functions/opensea</small>
    </div>
    <div id="out" class="grid"></div>
  </div>

  <script>
    const out = document.getElementById('out');
    document.getElementById('go').addEventListener('click', async () => {
      const slug = document.getElementById('slug').value.trim();
      const site = document.getElementById('site').value.trim().replace(/\/$/,''); // remove trailing slash
      if(!site){ out.innerHTML = '<div class="card err">Enter your Netlify site URL.</div>'; return; }
      out.innerHTML = '<div class="card">Loadingâ€¦</div>';
      try {
        const url = `${site}/.netlify/functions/opensea?slug=${encodeURIComponent(slug)}`;
        const r = await fetch(url);
        const j = await r.json();
        if(!r.ok){ throw new Error(j && j.error ? j.error : 'Request failed'); }
        out.innerHTML = `
          <div class="card">
            <div class="name">${j.name ?? '(unknown)'} <small>(${j.slug})</small></div>
            <div class="stat">ðŸ§© Items: ${j.total_supply ?? 'â€”'}</div>
            <div class="stat">ðŸ‘¥ Holders: ${j.num_owners ?? 'â€”'}</div>
            <div class="stat">ðŸ’° Floor: ${j.floor_price ?? 'â€”'} ETH</div>
          </div>
        `;
      } catch (e) {
        out.innerHTML = '<div class="card err">Error: ' + e.message + '</div>';
      }
    });
  </script>
</body>
</html>